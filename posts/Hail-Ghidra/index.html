<!DOCTYPE html><html lang="en-US" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Hail Ghidra" /><meta name="author" content="arraiz" /><meta property="og:locale" content="en_US" /><meta name="description" content="Bypassing the login system on a binary" /><meta property="og:description" content="Bypassing the login system on a binary" /><link rel="canonical" href="https://arraiz.github.io/posts/Hail-Ghidra/" /><meta property="og:url" content="https://arraiz.github.io/posts/Hail-Ghidra/" /><meta property="og:site_name" content="This looks Secure" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-09-10T09:55:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hail Ghidra" /><meta name="twitter:site" content="@arraiz0xF" /><meta name="twitter:creator" content="@arraiz" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"headline":"Hail Ghidra","dateModified":"2019-09-10T09:55:00+02:00","datePublished":"2019-09-10T09:55:00+02:00","description":"Bypassing the login system on a binary","url":"https://arraiz.github.io/posts/Hail-Ghidra/","mainEntityOfPage":{"@type":"WebPage","@id":"https://arraiz.github.io/posts/Hail-Ghidra/"},"@type":"BlogPosting","author":{"@type":"Person","name":"arraiz"},"@context":"https://schema.org"}</script><title>Hail Ghidra | This looks Secure</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://pbs.twimg.com/profile_images/1012970483359285253/PF4N462e_400x400.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">This looks Secure</a></div><div class="site-subtitle font-italic">A blog about breaking stuff</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/arraiz" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/arraiz0xF" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['mikeldiezgarcia','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG â€º <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Hail Ghidra</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Hail Ghidra</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Sep 10, 2019, 9:55 AM +0200" > Sep 10, 2019 <i class="unloaded">2019-09-10T09:55:00+02:00</i> </span> by <span class="author"> arraiz </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1269 words">7 min</span></div></div><div class="post-content"><h2 id="bypassing-the-login-system-on-a-binary">Bypassing the login system on a binary</h2><h3 id="introduction">Introduction</h3><hr /><p>As a student, one of the courses I enjoyed the most was one about understanding the deep structure and workflow inside an operating system with the help of <a href="https://en.wikipedia.org/wiki/Modern_Operating_Systems">Modern Operating Systems</a> book by Andrew Tanenbaum.</p><p>The coding part was the most funny for me and my friends. In those coding labs the student tries to reveal hidden information in the different UNIX system <strong>shared resources</strong> like unix sockets for example.</p><p>Today we will try to analyze one of those programs particularly an exam.</p><p>The exam program hides certain information within the Operating System for students to work to reveal that data, if so, the program reveals a number called <strong>secret</strong>, the <strong>more</strong> secrets the <strong>highest</strong> the grade.</p><p>Before access the program first a login is done via the student identification and a password.</p><blockquote><p>In this blog I will try to get inside the exam using simple <strong>reverse engineering</strong> techniques</p></blockquote><p>(the info showed in this blog was gathered <strong>long time ago</strong>)</p><p>(this is not a tutorial of how to decompile or break a binary file)</p><h3 id="lets-jump-right-into-it">Letâ€™s jump right into it</h3><hr /><p>The binary program that contains the exam is called <em>monitor</em>:</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>file monitor
monitor: ELF 64-bit LSB executable, x86-64, version 1 <span class="o">(</span>SYSV<span class="o">)</span>, dynamically linked, interpreter /lib64/l, <span class="k">for </span>GNU/Linux 2.6.24, BuildID[sha1]<span class="o">=</span><span class="k">***</span>68984e4bcc8dbe5a70d81<span class="k">*****</span>8cccd9f82a5, with debug_info, not stripped

</pre></table></code></div></div><p>The file is a <strong>ELF</strong> (executable) dynamically linked for <strong>64 bit</strong> and for GNU linux using GCC.</p><p><em>readelf</em> gives us more information about the file, in this case searching for info like <strong>passwords</strong> or students <strong>identification</strong> numbers (spanish identification card number or DNI)</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>arraiz@mintVM:~/Desktop/ghidra<span class="nv">$ </span>readelf monitor <span class="nt">-all</span> | <span class="nb">grep </span>DNI
   243: 0000000000401f30    77 FUNC    GLOBAL DEFAULT   13 DNItol

</pre></table></code></div></div><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nv">$ </span>arraiz@mintVM:~/Desktop/ghidra<span class="nv">$ </span>readelf monitor <span class="nt">-a</span> | <span class="nb">grep </span>pas
   126: 0000000000402510   209 FUNC    GLOBAL DEFAULT   13 check_passwd

</pre></table></code></div></div><p>Here we see some declarations to <strong>C functions</strong> in the program, this information here is really helpful when switching to <a href="https://www.hex-rays.com/products/ida/"><strong>IDA</strong></a> or <strong>Ghidra</strong> for code analysis.</p><p>10 minutes later collecting data about functions definitions and strings reveal some <strong>HARDCODED</strong> strings inside the binary.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nv">$ </span>arraiz@mintVM:~/Desktop/ghidra<span class="nv">$ </span>strings monitor
14<span class="k">******</span>F
....
....
omitted lines
....
....
100<span class="k">**</span>01<span class="k">*</span>E
100<span class="k">**</span>01<span class="k">*</span>E
</pre></table></code></div></div><p>Holly cows</p><p>Those are the <strong>Identification numbers</strong> (+40) of all students, remember that those IDs <strong>are the program password</strong> as well.</p><p>There are also some â€˜testingâ€™ identification numbers with fake IDs for development maybe.</p><p>The point here is that the IDs are not even encrypted or hashed.</p><p>The last try to get more hardcoded strings in the binary gives <strong>this</strong>.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="nv">$ </span>arraiz@mintVM:~/Desktop/ghidra<span class="nv">$ </span>strings monitor | <span class="nb">grep </span>key
<span class="nt">-----BEGIN</span> RSA PRIVATE KEY-----
MIIEowI<span class="k">*********************************************************</span>
II/UIZAUuRpYigRbjbWI8gb9bF0SWKWOoP9a+fmhdQ7Stkl79i2SsFyzU67zIYHg
x74ORxr4CU9GE6VnRp6y61nFmR6qTko/fOIFoik5McdkeyW2cezYvVtOafokOhTr
tl09k2Udi1Kl6+NxA4B+mgvRGJ9KM7IhCNWxOsn4G7W1bWjKYuqTUQ0DaE7b394W
XLCCbeh41Zfeyy3EIN2ipD3gsoePxx3URomeRFS0MCyH9vuJVblmrg/JrYlgpOQC+nueHe1OzfWU97s0jE4vSVgttTPmOYPqfMjsMQIDAQABAoIBAGB2cJnNeGQRkJcN
5LHFEOHfcT/8OuwhvOm9IRCDr3qsumL/vEfW8ge8GaCPbzBmRsO/KNdOytZi7yKm
jVvReCs89ooS3c4SowfQHvUWfKLA487cLX1sznPYTiMovICPeKcel7QqIWsH8PWX
Bd7FN7497GZs/c+wxdkDIngGYSiPbAzSI58n6X7sM8+EPFl4ESPfRzG9IWjXba3u
WsuUidhDAuldBYJrQbAM6thPXWDv85948iMpyNe18eT31z9Jnpq4OceG6Hc51A1i
o75YfoH5xQgmHFC7eY8hm5QNw+pgQMYREsvJBrBKgSUysciXhXhxglNDJaNbBMYH
3Iuo5b0CgYEA4ap1LLHAFq9ytL8iTbMZ7ibucwy6fA4QJl5OliJev4Oh/ObA0hB9
Vdbj334VEogZIHR4je/eAUq1IZyMx7dyba0MBrVHSwDW97ejjvFtTn8aAg9X83Z7
RsQIhBNGtGX+zlB8cCVuvrTwivbHBaIDwrZCtclKY7nHBTPBzLl7lM8CgYEA2Ypp
eIOimxuYfx4M+3eVDTOd4QVn+4fGykXoiqzxtAN7mtoCapXPedUxvSANrbQJvq94
j59qAZaCfvNzz9Y7N9q1++JI67O03tr8fp4UZGBBIB3+tBW2s1kkd339Kl54lf4S
Gf00zGPsQKPA1fVYqRI97YYhZbJVM5NQxNSFrv8CgYBRFIizPU5SGEmzbXUqy64G
ZlCIX8tlJTxiPMIpqUG3t9js4A/pqekOfX40X728gc/dXFuwS73NYwU/hVsDqwLf
KyzGAD4UUcHrET0f79ihOoOit9aW8DwMygRxR
<span class="k">***************************</span>
fh3r6N3khOxgDx+TqhUf+wKBgQCr/8T+lU22x63eK/tlxBnkc0BMD0M03BiwC3Ae
<span class="k">**********************</span>
XTlJ9EsBl4e7kDGYCZmnCDXodmYSD5kKLafaE4+gIosZ9C+kLNggjLzNJ6xFW+2x
ivlil7xGUZD2AAkRatTraYEGw+Uh6t2TEOFzDTpZrV+li7QLEbJHH/s99i9pdPuy
dLoyLwKBgD1CFDmKye8SnqfA+BOjLWXpoZ8kfWJc5KhRmxNK3g357iQBmIzz7kRP
/MisZoI+cArEy7ChlsBhQUTKmi/HWd5kZ6pED3hkkzztU9Rh9SfI7mlUplmZBtvf
ZvlYkArbn0TUbn4dsKfCtfsqt3ontIshsLcxDdFRGcc87i7xbACJ
<span class="nt">-----END</span> RSA PRIVATE KEY-----
</pre></table></code></div></div><p>Mother of horses.</p><p>That is a private key perhaps used to connect to the server used to process the marks of all students doing some <strong>data encription</strong> ?.</p><p>Because this post is intended to break the login, the key founded here will be used in another chapter (?).</p><p>Now time to check if the login still available with the data founded in the binary.</p><p>The ID numbers are working fine but the program asks for another code, an â€˜access codeâ€™.</p><div class="language-shell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nv">$ </span>arraiz@mintVM:~/Desktop/ghidra<span class="nv">$ </span>./monitor
Introduce tu DNI <span class="o">(</span>con letra<span class="o">)</span><span class="nb">.</span>
1<span class="k">********</span>

Introduce el codigo de acceso:

</pre></table></code></div></div><p>No other codes or password were found in the â€˜string analysisâ€™ so is time to take <a href="https://github.com/NationalSecurityAgency/ghidra">King Ghidorah</a> out.</p><p>Once <strong>decompiled</strong> (buzzword_counter++) all code inside the binary <strong>Ghidra</strong> gives a <strong>C implementation</strong> of the functions inside the binary (some of them discovered in the string analysis), so is time to find some â€˜access codeâ€™ o â€˜passâ€™ functions.</p><p><strong>Bingo</strong></p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
</pre><td class="rouge-code"><pre>  <span class="kt">int</span> <span class="nf">check_passwd</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

  <span class="p">{</span>
    <span class="kt">long</span> <span class="n">lVar1</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">iVar2</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">lVar3</span><span class="p">;</span>
    <span class="n">byte</span> <span class="o">*</span><span class="n">pbVar4</span><span class="p">;</span>
    <span class="n">byte</span> <span class="o">*</span><span class="n">pbVar5</span><span class="p">;</span>
    <span class="kt">long</span> <span class="n">in_FS_OFFSET</span><span class="p">;</span>
    <span class="n">bool</span> <span class="n">bVar6</span><span class="p">;</span>
    <span class="n">bool</span> <span class="n">bVar7</span><span class="p">;</span>
    <span class="n">bool</span> <span class="n">bVar8</span><span class="p">;</span>
    <span class="n">byte</span> <span class="n">bVar9</span><span class="p">;</span>
    <span class="kt">char</span> <span class="n">buf</span> <span class="p">[</span><span class="mi">256</span><span class="p">];</span>

    <span class="n">bVar9</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">lVar1</span> <span class="o">=</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">);</span>
    <span class="n">bVar6</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
    <span class="n">bVar8</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
    <span class="n">__printf_chk</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">msg_monitor</span><span class="p">[(</span><span class="kt">long</span><span class="p">)</span><span class="n">lang</span><span class="p">][</span><span class="mi">5</span><span class="p">]);</span>
    <span class="n">get_pwd</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span><span class="mi">7</span><span class="p">);</span>
    <span class="n">lVar3</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
    <span class="n">pbVar4</span> <span class="o">=</span> <span class="p">(</span><span class="n">byte</span> <span class="o">*</span><span class="p">)</span><span class="n">buf</span><span class="p">;</span>
    <span class="n">pbVar5</span> <span class="o">=</span> <span class="p">(</span><span class="n">byte</span> <span class="o">*</span><span class="p">)</span><span class="s">"asipwd"</span><span class="p">;</span>
    <span class="k">do</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">lVar3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
      <span class="n">lVar3</span> <span class="o">=</span> <span class="n">lVar3</span> <span class="o">+</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
      <span class="n">bVar6</span> <span class="o">=</span> <span class="o">*</span><span class="n">pbVar4</span> <span class="o">&lt;</span> <span class="o">*</span><span class="n">pbVar5</span><span class="p">;</span>
      <span class="n">bVar8</span> <span class="o">=</span> <span class="o">*</span><span class="n">pbVar4</span> <span class="o">==</span> <span class="o">*</span><span class="n">pbVar5</span><span class="p">;</span>
      <span class="n">pbVar4</span> <span class="o">=</span> <span class="n">pbVar4</span> <span class="o">+</span> <span class="p">(</span><span class="n">ulong</span><span class="p">)</span><span class="n">bVar9</span> <span class="o">*</span> <span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
      <span class="n">pbVar5</span> <span class="o">=</span> <span class="n">pbVar5</span> <span class="o">+</span> <span class="p">(</span><span class="n">ulong</span><span class="p">)</span><span class="n">bVar9</span> <span class="o">*</span> <span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">bVar8</span><span class="p">);</span>
    <span class="n">iVar2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="n">bVar7</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="n">bVar6</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">bVar8</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">bVar6</span><span class="p">;</span>
    <span class="n">bVar6</span> <span class="o">=</span> <span class="p">(</span><span class="o">!</span><span class="n">bVar6</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">bVar8</span><span class="p">)</span> <span class="o">==</span> <span class="n">bVar6</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">bVar6</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">lVar3</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
      <span class="n">pbVar4</span> <span class="o">=</span> <span class="p">(</span><span class="n">byte</span> <span class="o">*</span><span class="p">)</span><span class="n">buf</span><span class="p">;</span>
      <span class="n">pbVar5</span> <span class="o">=</span> <span class="p">(</span><span class="n">byte</span> <span class="o">*</span><span class="p">)</span><span class="s">"isapwd"</span><span class="p">;</span>
      <span class="k">do</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">lVar3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
        <span class="n">lVar3</span> <span class="o">=</span> <span class="n">lVar3</span> <span class="o">+</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">bVar7</span> <span class="o">=</span> <span class="o">*</span><span class="n">pbVar4</span> <span class="o">&lt;</span> <span class="o">*</span><span class="n">pbVar5</span><span class="p">;</span>
        <span class="n">bVar6</span> <span class="o">=</span> <span class="o">*</span><span class="n">pbVar4</span> <span class="o">==</span> <span class="o">*</span><span class="n">pbVar5</span><span class="p">;</span>
        <span class="n">pbVar4</span> <span class="o">=</span> <span class="n">pbVar4</span> <span class="o">+</span> <span class="p">(</span><span class="n">ulong</span><span class="p">)</span><span class="n">bVar9</span> <span class="o">*</span> <span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">pbVar5</span> <span class="o">=</span> <span class="n">pbVar5</span> <span class="o">+</span> <span class="p">(</span><span class="n">ulong</span><span class="p">)</span><span class="n">bVar9</span> <span class="o">*</span> <span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">bVar6</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">bVar6</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">lVar3</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
        <span class="n">pbVar4</span> <span class="o">=</span> <span class="p">(</span><span class="n">byte</span> <span class="o">*</span><span class="p">)</span><span class="n">buf</span><span class="p">;</span>
        <span class="n">pbVar5</span> <span class="o">=</span> <span class="p">(</span><span class="n">byte</span> <span class="o">*</span><span class="p">)</span><span class="s">"prfasi"</span><span class="p">;</span>
        <span class="k">do</span> <span class="p">{</span>
          <span class="k">if</span> <span class="p">(</span><span class="n">lVar3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
          <span class="n">lVar3</span> <span class="o">=</span> <span class="n">lVar3</span> <span class="o">+</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
          <span class="n">bVar7</span> <span class="o">=</span> <span class="o">*</span><span class="n">pbVar4</span> <span class="o">&lt;</span> <span class="o">*</span><span class="n">pbVar5</span><span class="p">;</span>
          <span class="n">bVar6</span> <span class="o">=</span> <span class="o">*</span><span class="n">pbVar4</span> <span class="o">==</span> <span class="o">*</span><span class="n">pbVar5</span><span class="p">;</span>
          <span class="n">pbVar4</span> <span class="o">=</span> <span class="n">pbVar4</span> <span class="o">+</span> <span class="p">(</span><span class="n">ulong</span><span class="p">)</span><span class="n">bVar9</span> <span class="o">*</span> <span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
          <span class="n">pbVar5</span> <span class="o">=</span> <span class="n">pbVar5</span> <span class="o">+</span> <span class="p">(</span><span class="n">ulong</span><span class="p">)</span><span class="n">bVar9</span> <span class="o">*</span> <span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">bVar6</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">bVar6</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">lVar3</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
          <span class="n">pbVar4</span> <span class="o">=</span> <span class="p">(</span><span class="n">byte</span> <span class="o">*</span><span class="p">)</span><span class="n">buf</span><span class="p">;</span>
          <span class="n">pbVar5</span> <span class="o">=</span> <span class="p">(</span><span class="n">byte</span> <span class="o">*</span><span class="p">)</span><span class="s">"devasi"</span><span class="p">;</span>
          <span class="k">do</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">lVar3</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>
            <span class="n">lVar3</span> <span class="o">=</span> <span class="n">lVar3</span> <span class="o">+</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
            <span class="n">bVar7</span> <span class="o">=</span> <span class="o">*</span><span class="n">pbVar4</span> <span class="o">&lt;</span> <span class="o">*</span><span class="n">pbVar5</span><span class="p">;</span>
            <span class="n">bVar6</span> <span class="o">=</span> <span class="o">*</span><span class="n">pbVar4</span> <span class="o">==</span> <span class="o">*</span><span class="n">pbVar5</span><span class="p">;</span>
            <span class="n">pbVar4</span> <span class="o">=</span> <span class="n">pbVar4</span> <span class="o">+</span> <span class="p">(</span><span class="n">ulong</span><span class="p">)</span><span class="n">bVar9</span> <span class="o">*</span> <span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
            <span class="n">pbVar5</span> <span class="o">=</span> <span class="n">pbVar5</span> <span class="o">+</span> <span class="p">(</span><span class="n">ulong</span><span class="p">)</span><span class="n">bVar9</span> <span class="o">*</span> <span class="o">-</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
          <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">bVar6</span><span class="p">);</span>
          <span class="n">iVar2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">((</span><span class="o">!</span><span class="n">bVar7</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">bVar6</span><span class="p">)</span> <span class="o">==</span> <span class="n">bVar7</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">developer</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
            <span class="n">iVar2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
          <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">lVar1</span> <span class="o">==</span> <span class="o">*</span><span class="p">(</span><span class="kt">long</span> <span class="o">*</span><span class="p">)(</span><span class="n">in_FS_OFFSET</span> <span class="o">+</span> <span class="mh">0x28</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">return</span> <span class="n">iVar2</span><span class="p">;</span>
    <span class="p">}</span>
                      <span class="cm">/* WARNING: Subroutine does not return */</span>
    <span class="n">__stack_chk_fail</span><span class="p">();</span>
  <span class="p">}</span>
</pre></table></code></div></div><p>There are some values <strong>â€˜asipwdâ€™ , â€˜isapwdâ€™, â€˜prfasiâ€™, â€˜devasiâ€™</strong> hardcoded inside the C function, lets give them a shotâ€¦</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>Introduce tu DNI (con letra).
1********(fake ID founded)

Introduce el codigo de acceso:
******

...........
omitted lines
...........

1.- EJERCICIO 1: ******
2.- EJERCICIO 2: ******
3.- EJERCICIO 3: ******
4.- EJERCICIO 4: ******
5.- EJERCICIO 5: ******
6.- EJERCICIO 6: ******
7.- EJERCICIO 7: ******
0.- FIN DE LA PRUEBA (necesario)

-------
</pre></table></code></div></div><p><strong>Now we are IN!</strong></p><p><strong>NOW I CAN LEARN ABOUT IPCs!</strong></p><p>In other posts I will try to deconstruct the function that generate the secrets or use the private key to make some <em>h4ck1ng</em> or maybe not.</p><h3 id="conclusions">Conclusions</h3><hr /><p>When writing software that is going to be for public use, it must be taken into account that there are tools and techniques to analyze the code within it and it is not necessary to have high knowledge about software to perform an analysis.</p><p>This blog was intended to demonstrate that with 3 tools (2 of them Linux commands) you can perform a simple analysis of a binary file.</p><h3 id="regards-to-jtpfevaa">Regards to jtpfevaa</h3></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/reverse-enginerring/'>reverse enginerring</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >Linux</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hail Ghidra - This looks Secure&url=https://arraiz.github.io/posts/Hail-Ghidra/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hail Ghidra - This looks Secure&u=https://arraiz.github.io/posts/Hail-Ghidra/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Hail Ghidra - This looks Secure&url=https://arraiz.github.io/posts/Hail-Ghidra/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/linux/">Linux</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div class="post-navigation d-flex justify-content-between"> <span class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></span> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> Â© 2021 <a href="https://twitter.com/arraiz0xF">Mikel (arraiz)</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/linux/">Linux</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://arraiz.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
